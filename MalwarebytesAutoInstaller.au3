#RequireAdmin

; When this script is run from the same folder/location
; as the installer, it will automatically run the setup
; file and will click through the screens to completion

Run('mbam-setup-2.2.1.1043.exe')
AutoItSetOption('MouseCoordMode', 0)

WinWait('Select Setup Language')
WinActivate('Select Setup Language')
MouseClick('primary', 173, 130, 1, 0)


; This clicks through the various screens in the installer, 
; and selects 'No' for the option to activate the free
; Malwarebytes Premium trial

WinWait('Setup - Malwarebytes Anti-Malware')
WinActivate('Setup - Malwarebytes Anti-Malware')
MouseClick('primary', 365, 365, 1, 0)
Sleep(300)
MouseClick('primary', 50, 302, 1, 0)
MouseClick('primary', 365, 365, 1, 0)
Sleep(300)
MouseClick('primary', 365, 365, 1, 0)
Sleep(300)
MouseClick('primary', 365, 365, 1, 0)
Sleep(300)
MouseClick('primary', 365, 365, 1, 0)
Sleep(300)
MouseClick('primary', 53, 166, 1, 0)
MouseClick('primary', 365, 365, 1, 0)
Sleep(300)
MouseClick('primary', 365, 365, 1, 0)
WinWait('Setup - Malwarebytes Anti-Malware', 'Setup has finished installing Malwarebytes Anti-Malware on your computer.')
WinActivate('Setup - Malwarebytes Anti-Malware')
MouseClick('primary', 189, 185, 1, 0)
MouseClick('primary', 365, 365, 1, 0)
